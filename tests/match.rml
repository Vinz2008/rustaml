let match_switch1 a = match a with
  | 1 -> "hello"
  | 2 -> "world"
  | _ -> "test" ;;

let match_switch2 a = match a with
  | 1 -> 12
  | 2 -> 36
  | a -> a ;;

// put rand back instead of these numbers in these calls for defeating optimizations after adding seeds for tests
let r1 = 1 ;;
let r2 = 2 ;;
let r3 = 3 ;;
let m1 = match_switch1 r1 ;;
let _ = print m1 ;;

let m2 = match_switch2 r2 ;;
let _ = print m2 ;;

let match_bool a = match a with
  | true -> 12
  | false -> 6 ;;

let m_b = match_bool (r3 == 3) ;;
let _ = print m_b ;;

let match_switch_int_no_fallback a = match a with
  | -9223372036854775808=..9223372036854775807 -> 3 ;;

let m_i_n_f = match_switch_int_no_fallback 2 ;;
let _ = print m_i_n_f ;;

let match_fail a = match a with 
  | 1 -> 3 ;;

let _ = print (match_fail 2) ;;